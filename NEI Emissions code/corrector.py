# -*- coding: utf-8 -*-
"""
Created on Tue Jul 11 13:44:29 2017

@author: tghosh
"""

import pandas as pd
import numpy as np


nei = pd.read_csv("NEIEMISSIONS.CSV")

print(nei.columns.tolist())

#['Unnamed: 0', 'eis facility id', 'site name', 'units', 'PNAME', 'EGRID ID', '1,1,2,2-Tetrachloroethane', '1,1,2-Trichloroethane', '1,2,4-Trichlorobenzene', '1,2-Dibromo-3-Chloropropane', '1,2-Dimethoxyethane', '1,2-Epoxybutane', '1,2-Propylenimine', '1,3-Butadiene', '1,3-Dichloropropene', '1,4-Dichlorobenzene', '1-Methylnaphthalene', '2,2,4-Trimethylpentane', '2,4,4 -Trichlorobiphenyl (PCB-28)', '2,4,5-Trichlorophenol', '2,4,6-Trichlorophenol', '2,4-Dinitrophenol', '2,4-Dinitrotoluene', '2,4-Toluene Diisocyanate', '2-Chloroacetophenone', '2-Chlorobiphenyl (PCB-1)', '2-Chloronaphthalene', '2-Methylnaphthalene', '2-Nitropropane', '3,3 -Dichlorobenzidine', '3,3 -Dimethoxybenzidine', '3,3 -Dimethylbenzidine', '3-Methylcholanthrene', '4,4 -Dichlorobiphenyl (PCB-15)', '4,4 -Methylenedianiline', '4,4 -Methylenediphenyl Diisocyanate', '4,6-Dinitro-o-Cresol', '4-Aminobiphenyl', '4-Dimethylaminoazobenzene', '4-Nitrobiphenyl', '4-Nitrophenol', '5-Methylchrysene', '7,12-Dimethylbenz[a]Anthracene', 'Acenaphthene', 'Acenaphthylene', 'Acetaldehyde', 'Acetamide', 'Acetonitrile', 'Acetophenone', 'Acrolein', 'Acrylamide', 'Acrylic Acid', 'Acrylonitrile', 'Allyl Chloride', 'Ammonia', 'Aniline', 'Anthracene', 'Antimony', 'Arsenic', 'Asbestos', 'Benz[a]Anthracene', 'Benzene', 'Benzidine', 'Benzo(g,h,i)Fluoranthene', 'Benzo[a]Pyrene', 'Benzo[b]Fluoranthene', 'Benzo[e]Pyrene', 'Benzo[g,h,i,]Perylene', 'Benzo[j]fluoranthene', 'Benzo[k]Fluoranthene', 'Benzofluoranthenes', 'Benzyl Chloride', 'Beryllium', 'Biphenyl', 'Bis(2-Ethylhexyl)Phthalate', 'Bromoform', 'Butyl Carbitol Acetate', 'Cadmium', 'Calcium Cyanamide', 'Carbazole', 'Carbitol Acetate', 'Carbon Disulfide', 'Carbon Monoxide', 'Carbon Tetrachloride', 'Carbonyl Sulfide', 'Catechol', 'Chlorine', 'Chloroacetic Acid', 'Chlorobenzene', 'Chloroform', 'Chloroprene', 'Chromic Acid (VI)', 'Chromium (VI)', 'Chromium III', 'Chrysene', 'Coal Tar', 'Cobalt', 'Coke Oven Emissions', 'Cresol/Cresylic Acid (Mixed Isomers)', 'Cumene', 'Cyanide', 'Decachlorobiphenyl (PCB-209)', 'Dibenz[a,h]acridine', 'Dibenzo[a,e]Pyrene', 'Dibenzo[a,h]Anthracene', 'Dibenzo[a,h]Pyrene', 'Dibenzo[a,j]Acridine', 'Dibenzofuran', 'Dibutyl Phthalate', 'Dichloroethyl Ether', 'Diethanolamine', 'Diethyl Sulfate', 'Diethylene Glycol Monobutyl Ether', 'Diethylene Glycol Monoethyl Ether', 'Diethylene Glycol Monomethyl Ether', 'Dimethyl Phthalate', 'Dimethyl Sulfate', 'Elemental Carbon portion of PM2.5-PRI', 'Epichlorohydrin', 'Ethyl Acrylate', 'Ethyl Benzene', 'Ethyl Chloride', 'Ethylene Dibromide', 'Ethylene Dichloride', 'Ethylene Glycol', 'Ethylene Glycol Methyl Ether', 'Ethylene Oxide', 'Ethylidene Dichloride', 'Extractable Organic Matter (EOM)', 'Fluoranthene', 'Fluorene', 'Formaldehyde', 'Glycol Ethers', 'Heptachlorobiphenyl', 'Hexachlorobenzene', 'Hexachlorobiphenyl', 'Hexachlorobutadiene', 'Hexachlorocyclopentadiene', 'Hexachloroethane', 'Hexamethylene Diisocyanate', 'Hexane', 'Hydrazine', 'Hydrochloric Acid', 'Hydrogen Cyanide', 'Hydrogen Fluoride', 'Hydrogen Sulfide', 'Hydroquinone', 'Indeno[1,2,3-c,d]Pyrene', 'Isophorone', 'Lead', 'Maleic Anhydride', 'Manganese', 'Mercury', 'Methanol', 'Methoxytriglycol', 'Methyl Bromide', 'Methyl Chloride', 'Methyl Chloroform', 'Methyl Iodide', 'Methyl Isobutyl Ketone', 'Methyl Methacrylate', 'Methyl Tert-Butyl Ether', 'Methylene Chloride', 'Methylhydrazine', 'N,N-Dimethylaniline', 'N,N-Dimethylformamide', 'N-Nitrosodimethylamine', 'N-Nitrosomorpholine', 'Naphthalene', 'Nickel', 'Nitrate portion of PM2.5-PRI', 'Nitrobenzene', 'Nitrogen Oxides', 'Organic Carbon portion of PM2.5-PRI', 'PAH, total', 'PAH/POM - Unspecified', 'PM Condensible', 'PM10 Filterable', 'PM10 Primary (Filt + Cond)', 'PM10-Primary from certain diesel engines', 'PM2.5 Filterable', 'PM2.5 Primary (Filt + Cond)', 'PM25-Primary from certain diesel engines', 'Pentachlorobiphenyl', 'Pentachloronitrobenzene', 'Pentachlorophenol', 'Perylene', 'Phenanthrene', 'Phenol', 'Phenyl Cellosolve', 'Phosgene', 'Phosphine', 'Phosphorus', 'Phthalic Anhydride', 'Polychlorinated Biphenyls', 'Propionaldehyde', 'Propylene Dichloride', 'Propylene Oxide', 'Pyrene', 'Quinoline', 'Quinone', 'Remaining PMFINE portion of PM2.5-PRI', 'Selenium', 'Styrene', 'Styrene Oxide', 'Sulfate Portion of PM2.5-PRI', 'Sulfur Dioxide', 'Tetrachlorobiphenyl', 'Tetrachloroethylene', 'Titanium Tetrachloride', 'Toluene', 'Toluene-2,4-Diamine', 'Trichloroethylene', 'Triethylamine', 'Trifluralin', 'Vinyl Acetate', 'Vinyl Bromide', 'Vinyl Chloride', 'Vinylidene Chloride', 'Volatile Organic Compounds', 'Xylenes (Mixed Isomers)', 'm-Cresol', 'm-Xylene', 'o-Anisidine', 'o-Cresol', 'o-Toluidine', 'o-Xylene', 'p-Cresol', 'p-Dioxane', 'p-Phenylenediamine', 'p-Xylene']

nei1 = nei.groupby(['EGRID ID'], as_index=False)['1,1,2,2-Tetrachloroethane', '1,1,2-Trichloroethane', '1,2,4-Trichlorobenzene', '1,2-Dibromo-3-Chloropropane', '1,2-Dimethoxyethane', '1,2-Epoxybutane', '1,2-Propylenimine', '1,3-Butadiene', '1,3-Dichloropropene', '1,4-Dichlorobenzene', '1-Methylnaphthalene', '2,2,4-Trimethylpentane', '2,4,4 -Trichlorobiphenyl (PCB-28)', '2,4,5-Trichlorophenol', '2,4,6-Trichlorophenol', '2,4-Dinitrophenol', '2,4-Dinitrotoluene', '2,4-Toluene Diisocyanate', '2-Chloroacetophenone', '2-Chlorobiphenyl (PCB-1)', '2-Chloronaphthalene', '2-Methylnaphthalene', '2-Nitropropane', '3,3 -Dichlorobenzidine', '3,3 -Dimethoxybenzidine', '3,3 -Dimethylbenzidine', '3-Methylcholanthrene', '4,4 -Dichlorobiphenyl (PCB-15)', '4,4 -Methylenedianiline', '4,4 -Methylenediphenyl Diisocyanate', '4,6-Dinitro-o-Cresol', '4-Aminobiphenyl', '4-Dimethylaminoazobenzene', '4-Nitrobiphenyl', '4-Nitrophenol', '5-Methylchrysene', '7,12-Dimethylbenz[a]Anthracene', 'Acenaphthene', 'Acenaphthylene', 'Acetaldehyde', 'Acetamide', 'Acetonitrile', 'Acetophenone', 'Acrolein', 'Acrylamide', 'Acrylic Acid', 'Acrylonitrile', 'Allyl Chloride', 'Ammonia', 'Aniline', 'Anthracene', 'Antimony', 'Arsenic', 'Asbestos', 'Benz[a]Anthracene', 'Benzene', 'Benzidine', 'Benzo(g,h,i)Fluoranthene', 'Benzo[a]Pyrene', 'Benzo[b]Fluoranthene', 'Benzo[e]Pyrene', 'Benzo[g,h,i,]Perylene', 'Benzo[j]fluoranthene', 'Benzo[k]Fluoranthene', 'Benzofluoranthenes', 'Benzyl Chloride', 'Beryllium', 'Biphenyl', 'Bis(2-Ethylhexyl)Phthalate', 'Bromoform', 'Butyl Carbitol Acetate', 'Cadmium', 'Calcium Cyanamide', 'Carbazole', 'Carbitol Acetate', 'Carbon Disulfide', 'Carbon Monoxide', 'Carbon Tetrachloride', 'Carbonyl Sulfide', 'Catechol', 'Chlorine', 'Chloroacetic Acid', 'Chlorobenzene', 'Chloroform', 'Chloroprene', 'Chromic Acid (VI)', 'Chromium (VI)', 'Chromium III', 'Chrysene', 'Coal Tar', 'Cobalt', 'Coke Oven Emissions', 'Cresol/Cresylic Acid (Mixed Isomers)', 'Cumene', 'Cyanide', 'Decachlorobiphenyl (PCB-209)', 'Dibenz[a,h]acridine', 'Dibenzo[a,e]Pyrene', 'Dibenzo[a,h]Anthracene', 'Dibenzo[a,h]Pyrene', 'Dibenzo[a,j]Acridine', 'Dibenzofuran', 'Dibutyl Phthalate', 'Dichloroethyl Ether', 'Diethanolamine', 'Diethyl Sulfate', 'Diethylene Glycol Monobutyl Ether', 'Diethylene Glycol Monoethyl Ether', 'Diethylene Glycol Monomethyl Ether', 'Dimethyl Phthalate', 'Dimethyl Sulfate', 'Elemental Carbon portion of PM2.5-PRI', 'Epichlorohydrin', 'Ethyl Acrylate', 'Ethyl Benzene', 'Ethyl Chloride', 'Ethylene Dibromide', 'Ethylene Dichloride', 'Ethylene Glycol', 'Ethylene Glycol Methyl Ether', 'Ethylene Oxide', 'Ethylidene Dichloride', 'Extractable Organic Matter (EOM)', 'Fluoranthene', 'Fluorene', 'Formaldehyde', 'Glycol Ethers', 'Heptachlorobiphenyl', 'Hexachlorobenzene', 'Hexachlorobiphenyl', 'Hexachlorobutadiene', 'Hexachlorocyclopentadiene', 'Hexachloroethane', 'Hexamethylene Diisocyanate', 'Hexane', 'Hydrazine', 'Hydrochloric Acid', 'Hydrogen Cyanide', 'Hydrogen Fluoride', 'Hydrogen Sulfide', 'Hydroquinone', 'Indeno[1,2,3-c,d]Pyrene', 'Isophorone', 'Lead', 'Maleic Anhydride', 'Manganese', 'Mercury', 'Methanol', 'Methoxytriglycol', 'Methyl Bromide', 'Methyl Chloride', 'Methyl Chloroform', 'Methyl Iodide', 'Methyl Isobutyl Ketone', 'Methyl Methacrylate', 'Methyl Tert-Butyl Ether', 'Methylene Chloride', 'Methylhydrazine', 'N,N-Dimethylaniline', 'N,N-Dimethylformamide', 'N-Nitrosodimethylamine', 'N-Nitrosomorpholine', 'Naphthalene', 'Nickel', 'Nitrate portion of PM2.5-PRI', 'Nitrobenzene', 'Nitrogen Oxides', 'Organic Carbon portion of PM2.5-PRI', 'PAH, total', 'PAH/POM - Unspecified', 'PM Condensible', 'PM10 Filterable', 'PM10 Primary (Filt + Cond)', 'PM10-Primary from certain diesel engines', 'PM2.5 Filterable', 'PM2.5 Primary (Filt + Cond)', 'PM25-Primary from certain diesel engines', 'Pentachlorobiphenyl', 'Pentachloronitrobenzene', 'Pentachlorophenol', 'Perylene', 'Phenanthrene', 'Phenol', 'Phenyl Cellosolve', 'Phosgene', 'Phosphine', 'Phosphorus', 'Phthalic Anhydride', 'Polychlorinated Biphenyls', 'Propionaldehyde', 'Propylene Dichloride', 'Propylene Oxide', 'Pyrene', 'Quinoline', 'Quinone', 'Remaining PMFINE portion of PM2.5-PRI', 'Selenium', 'Styrene', 'Styrene Oxide', 'Sulfate Portion of PM2.5-PRI', 'Sulfur Dioxide', 'Tetrachlorobiphenyl', 'Tetrachloroethylene', 'Titanium Tetrachloride', 'Toluene', 'Toluene-2,4-Diamine', 'Trichloroethylene', 'Triethylamine', 'Trifluralin', 'Vinyl Acetate', 'Vinyl Bromide', 'Vinyl Chloride', 'Vinylidene Chloride', 'Volatile Organic Compounds', 'Xylenes (Mixed Isomers)', 'm-Cresol', 'm-Xylene', 'o-Anisidine', 'o-Cresol', 'o-Toluidine', 'o-Xylene', 'p-Cresol', 'p-Dioxane', 'p-Phenylenediamine', 'p-Xylene'].sum()


#nei1.to_csv('chk.csv')


merger = nei[['eis facility id', 'site name','EGRID ID']].copy()


nei2 = pd.merge(merger,nei1,left_on = ['EGRID ID'], right_on = ['EGRID ID'])


nei3 = nei2.drop_duplicates(subset='EGRID ID', keep='first')
                          
#nei3.to_csv('chk3.csv')

egrid = pd.read_csv("eGRIDPLNT2014.csv", header=0,usecols=['EGRID ID','Plant name','Generation'], nrows= 8504, error_bad_lines=False)

nei4 = pd.merge(egrid,nei3,left_on = ['EGRID ID'], right_on = ['EGRID ID'])

nei4.to_excel('chk4.xlsx')